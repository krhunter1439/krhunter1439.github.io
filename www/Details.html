<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" type="text/css" href="main.css">
        <link rel="stylesheet" type="text/css" href="main.js">
        <meta charset="utf-8">
        <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no, width=device-width">
        <title>Life on the Spectrum</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
  <!--Fonts-->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700" type="text/css">

  <!--Jquery Import-->
  <script src="//code.jquery.com/jquery-1.11.3.min.js" type="text/javascript"></script>
  <script src="//code.jquery.com/jquery-migrate-1.2.1.min.js" type="text/javascript"></script>

  <!-- Material Design Lite-->
  <link rel="stylesheet" href="https://storage.googleapis.com/code.getmdl.io/1.0.0/material.blue-red.min.css" />
  <script src="https://storage.googleapis.com/code.getmdl.io/1.0.0/material.min.js"></script>
  <script src="//cdn.ckeditor.com/4.5.1/basic/ckeditor.js"></script>
  <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    </head> 
    <style>
form {
    display: inline-block;
}
.list{
    overflow: auto;
    margin-left:16%;
    margin-right:16%;
}</style>
    <body>
     
<div id="mySidenav" class="sidenav">
  <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
      <a type="button" value="Enter Protected Area" onClick="passWord()" href="index.html">Home</a>
  <a type="button" value="Enter Protected Area" onClick="passWord()" href="About.html">About</a>
  <a type="button" value="Enter Protected Area" onClick="passWord()"href="PECS.html">PECS</a>
  <a type="button" value="Enter Protected Area" onClick="passWord()"href="Sensory.html">Sensory</a>
  <a type="button" value="Enter Protected Area" onClick="passWord()"href="Details.html">Details</a>
    <a type="button" value="Enter Protected Area" onClick="passWord()"href="Contact.html">Contact</a>
    
</div>

<div id="main">
 
  <span style="font-size:30px;cursor:pointer" onclick="openNav()" >&#9776; DETAILS</span>  
   
</div>

         <h2>Notes</h2>
  <button class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--primary" id="newNote">New Note</button>
  <br/>
  <form style="display: none;" name="notesForm" id="notesForm">
    <div class="mdl-textfield mdl-js-textfield">

      <input class="mdl-textfield__input" type="text" name="pastorName" id="pastorName" />
      <label class="mdl-textfield__label" for="pastorName">Title</label>
    </div>
    <br/>
    <div class="mdl-textfield mdl-js-textfield">
      <textarea class="mdl-textfield__input" name="notes" rows="7" id="notes"></textarea>
    </div>
  </form>
  <br/>
  <div style="display: none;" class="mdl-button mdl-js-button mdl-button--primary" id="button">
    Add
  </div>
  <br/>
  <div class="list"></div>
  

<script>
function openNav() {
  document.getElementById("mySidenav").style.width = "250px";
  document.getElementById("main").style.marginLeft = "100px";
  document.body.style.backgroundColor = "  #C8C6D7";
}

function closeNav() {
  document.getElementById("mySidenav").style.width = "0";
  document.getElementById("main").style.marginLeft= "0";
  document.body.style.backgroundColor = "";
}
var ckEditorID;

ckEditorID = 'notes';

function fnConsolePrint() {
  //console.log($('#' + ckEditorID).val());
  console.log(CKEDITOR.instances[ckEditorID].getData());
}
CKEDITOR.config.forcePasteAsPlainText = true;
CKEDITOR.replace(ckEditorID, {
  toolbar: [{
    items: ['Bold', 'Italic', 'Underline', 'Strike', '-', 'RemoveFormat']
  }, {
    items: ['Format']
  }, {
    items: ['Link', 'Unlink']
  }, {
    items: ['Indent', 'Outdent', '-', 'BulletedList', 'NumberedList']
  }, {
    items: ['Undo', 'Redo']
  }]
})
    
    $(document).ready(function() {
  var $newNote = $("#newNote");
  var $notesForm = $("#notesForm");
  var $button = $("#button");
  var $list = $(".list");
  var $pastorName = $('input[name=pastorName]');

  var toggleEl = function($el, direction, callback) {
    if (direction == "show") {
      $el.show("slow", function() {
        if (callback !== undefined) {
          callback();
        }
      });
    } else {
      $el.hide("slow", function() {
        if (callback !== undefined) {
          callback();
        }
      });
    }
  }

  var appendListItem = function(name, date, notes) {
    $list.append('<div class="item">' + name + '<br/>' + date + '<br/>' + notes + '<br/><button type="button" class="mdl-button mdl-js-button mdl-button--accent" id="delete">Delete</button>' + '</div>');
  }

  var saveToLocalStorage = function(name, date, notes) {
    if (localStorage.getItem("church_notes") === null) {
      localStorage.setItem("church_notes", JSON.stringify([]));
    }
    var data = JSON.parse(localStorage.getItem("church_notes"));
    var newNoteJSON = {
      name: name,
      date: date,
      notes: notes
    };
    data.push(newNoteJSON);
    localStorage.setItem("church_notes", JSON.stringify(data));
  }

  var retrieveFromLocalStorage = function() {
    if (localStorage.getItem("church_notes") !== null) {
      var data = JSON.parse(localStorage.getItem("church_notes"));
      for (i = 0, len = data.length; i < len; i++) {
        appendListItem(data[i].name, data[i].date, data[i].notes);
      }
    }
  }

  var appendNewNote = function(callback) {
    if ($pastorName.val() != "") {
      var pastorName = $pastorName.val();
      var notes = CKEDITOR.instances.notes.getData();
      var dt = new Date();
      var date = dt.toDateString();
      appendListItem(pastorName, date, notes);
      callback();
      $pastorName.val("");
      CKEDITOR.instances.notes.setData("");
      saveToLocalStorage(pastorName, date, notes);
    } else {
      alert("Note can't be blank.");
    }
  }

  retrieveFromLocalStorage();

  $newNote.on("click", function() {
    toggleEl($notesForm, "show", function() {
      toggleEl($newNote, "hide");
      toggleEl($button, "show");
    });
  });

  $button.on("click", function() {
    appendNewNote(function() {
      toggleEl($newNote, "show");
      toggleEl($notesForm, "hide");
      toggleEl($button, "hide");
    });
  });

  $(document).on('click', '#delete', function() {
    var $item = $(this).closest(".item");
    toggleEl($item, "hide", function() {
      $item.remove();
    });
  });
});
</script>
    </body>
</html>